<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>
	<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
	<style type="text/css">
		.wrapper{
		}
		.image-row{
			display: flex;
			flex-wrap: wrap;
		}
		.image-column{
			width: 48%;
			background: white;
			display: flex;
			margin: 8px;
		}
		.image-column > div{
			width: 50%;
			padding: 10px;
		}
		.image-column .image-wrapper{

		}
		.image-column .image-wrapper canvas{
			max-width: 100%;
		}
		.inputs-wrapper{
			padding: 10px;
		}
		label{
			display: block;
		}
		input{
			box-sizing: border-box;
			width: 100%;
		}

	</style>
</head>
<body>

	<div class="wrapper">
		<div class="image-row">
			<div class="image-column">
				<div class="image-wrapper">
					<canvas data-image="./placeholder.png" width="320" height="320"></canvas>
				</div>
				<div class="inputs-wrapper">
					<div>
						<label>Your name</label>
						<input type="text" name="name" >
					</div>
					<div>
						<label>Business name</label>
						<input type="text" name="bname" >
					</div>
					<div>
						<label>Address</label>
						<input type="text" name="address">
					</div>
				</div>
			</div>
			<div class="image-column">
				<div class="image-wrapper">
					<canvas data-image="https://via.placeholder.com/320" width="320" height="320"></canvas>
				</div>
				<div class="inputs-wrapper">
					<div>
						<label>Your name</label>
						<input type="text" name="name">
					</div>
					<div>
						<label>Business name</label>
						<input type="text" name="bname">
					</div>
					<div>
						<label>Address</label>
						<input type="text" name="address">
					</div>
				</div>
			</div>

			<div class="image-column">
				<div class="image-wrapper">
					<canvas data-image="https://via.placeholder.com/320" width="320" height="320"></canvas>
				</div>
				<div class="inputs-wrapper">
					<div>
						<label>Your name</label>
						<input type="text" name="name">
					</div>
					<div>
						<label>Business name</label>
						<input type="text" name="bname">
					</div>
					<div>
						<label>Address</label>
						<input type="text" name="address">
					</div>
				</div>
			</div>

			<div class="image-column">
				<div class="image-wrapper">
					<canvas data-image="https://via.placeholder.com/320" width="320" height="320"></canvas>
				</div>
				<div class="inputs-wrapper">
					<div>
						<label>Your name</label>
						<input type="text" name="name">
					</div>
					<div>
						<label>Business name</label>
						<input type="text" name="bname">
					</div>
					<div>
						<label>Address</label>
						<input type="text" name="address">
					</div>
				</div>
			</div>
			
		</div>
	</div>



	<script type="text/javascript">

		function testove(){
			//initialise each canvas and fill with image
			let canvas = document.getElementsByClassName(".image-column").find("canvas").toArray();
			canvas.forEach(c => {

				var context = c.getContext("2d");
				var img = new Image();
				img.src = $(c).data("image");
				img.onload = function () {
					context.drawImage(img, 0, 0, );
				};
			})


			$("input[type=text]").keyup(function(){
				let itsCanvas = $(this).closest(".image-column").find("canvas")[0]
				let name = $(this).closest(".inputs-wrapper").find("input[name='name']")[0].value
				let baname = $(this).closest(".inputs-wrapper").find("input[name='bname']")[0].value
				let addr = $(this).closest(".inputs-wrapper").find("input[name='address']")[0].value

				var context = itsCanvas.getContext("2d");
				console.log("redrawing canvas")

				context.clearRect(0, 0, itsCanvas.width, itsCanvas.height);
				var img = new Image();
				img.src = $(itsCanvas).data("image");

				var update = true;
				requestAnimationFrame(renderFunction);
				img.onload = () => update = true;

				function renderFunction(){
				    if(update){  // only raw if needed
				    	update = false;
				    	context.drawImage(img, 0, 0);

				    	context.fillStyle = "#F5F121";
				    	context.font = "22px sans-serif";

				    	context.fillText(name, 20, 50);
				    	context.fillText(baname, 20, 100);
				    	context.fillText(addr, 20, 150);

				    }
				    requestAnimationFrame(renderFunction);
				}



			})

		})

	</script>

</body>
</html>